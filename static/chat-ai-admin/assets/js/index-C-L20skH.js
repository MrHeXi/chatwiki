import{_ as O,b as q,B as ne,d as j,M as J,E as de}from"../../index.js";import{a as ie,e as ce,g as re,d as ue}from"./index-Cz_YIDX3.js";import{e as I,M as o,N as r,F as A,a2 as V,a3 as se,Z as y,u as b,W as d,k as C,ac as _e,S as c,Y as B,a9 as S,G as me,H as pe,Q as M,aa as N,a4 as ve,a5 as fe,B as ae,ad as ye,V as he,ae as ge,b as ee}from"./vue-chunks-Chs-lyDX.js";import{_ as ke}from"./index-DBNqHYGh.js";import{F as oe,_ as we}from"./index-VeYSCPCu.js";import{R as be,_ as Ce}from"./index-B7-ex2lw.js";import{S as Me,_ as Ae}from"./index-MD3V6K2I.js";import"./index-9H-48H6s.js";import{I as Te}from"./Password-cmG-BlhH.js";import{_ as $e}from"./index-DOqSVN3l.js";import{_ as xe,a as Ie}from"./index-DP_X7UEl.js";import"./dayjs-CkLU8sYs.js";import"./axios-Cm0UX6qg.js";import"./qs-DjYKlG5V.js";import"./crypto-js-BUUKnz8c.js";import"./Col-CvDsueo7.js";import"./collapseMotion-DN2MDQ98.js";import"./QuestionCircleOutlined-B0hVewZq.js";import"./inputProps-DYO7gEw-.js";import"./slide-CP07UJ8x.js";import"./index-CwZHIw9t.js";import"./CheckOutlined-D4HtVfaw.js";import"./DownOutlined-DRniQ56W.js";import"./TextArea-DvaABMYL.js";import"./move-DwQ0mPkQ.js";import"./index-B8boHKw3.js";import"./LeftOutlined-DnP_dahC.js";import"./RightOutlined-BSM_93j-.js";import"./index-DdoCKw3y.js";import"./index-Bz3n5ObF.js";import"./dropdown-T3bZiTSp.js";import"./index-C9DKKAWk.js";const Se={class:"page-tabs"},Ee=["onClick"],Ke={__name:"page-tabs",props:{value:{type:[Number,String]}},emits:["update:value","change"],setup(n,{emit:u}){const{t:s}=q(),a=u,_=n,h=I([{value:1,title:s("views.user.model.modelsHaveBeenAdded"),langKey:"views.user.model.modelsHaveBeenAdded"},{value:0,title:s("views.user.model.canAddAModel"),langKey:"views.user.model.canAddAModel"}]),k=m=>{a("update:value",m),a("change",m)};return(m,T)=>(o(),r("div",Se,[(o(!0),r(A,null,V(h.value,g=>(o(),r("div",{class:se(["tab-item",{active:_.value==g.value}]),onClick:l=>k(g.value),key:g.value},y(b(s)(g.langKey)),11,Ee))),128))]))}},Be=O(Ke,[["__scopeId","data-v-5999ba44"]]),Le=n=>(ve("data-v-57dc6c55"),n=n(),fe(),n),Re={class:"model-list"},Pe={class:"model-item-left"},Ne={class:"model-item-left-top"},De=["src"],Ve={class:"model-name"},Fe=Le(()=>d("div",{class:"line"},null,-1)),Ue={class:"model-tags"},ze={key:0,class:"tag"},Oe={class:"model-item-left-bottom"},qe={class:"model-desc"},He={class:"model-item-right"},Ge={__name:"model-list",props:{type:{type:Number,default:()=>1},list:{type:Array,default:()=>[]}},emits:["edit","new","see","remove","add"],setup(n,{emit:u}){const{t:s}=q(),a=u,_=n,h=l=>{a("see",N(l))},k=l=>{let $=N(l);a("edit",$,$.config_list[0])},m=l=>{a("new",N(l))},T=l=>{a("add",N(l))},g=l=>{let $=N(l);a("remove",$.config_list[0])};return(l,$)=>{const L=ke,p=ne;return o(),r("div",Re,[(o(!0),r(A,null,V(_.list,t=>(o(),r("div",{class:"model-item",key:t.model_define},[d("div",Pe,[d("div",Ne,[d("img",{class:"model-logo",src:t.model_icon_url,alt:""},null,8,De),d("div",Ve,y(t.model_name),1),Fe,d("div",Ue,[(o(!0),r(A,null,V(t.support_list,(i,v)=>(o(),r("div",{key:v},[C(L,null,_e({default:c(()=>[i!="SPEECH2TEXT"&&i!="TTS"?(o(),r("span",ze,y(i),1)):S("",!0)]),_:2},[i=="LLM"?{name:"title",fn:c(()=>[B("大语言模型，添加机器人时需要选择一个大语言模型。用户的提问将交由大语言模型，结合知识库给出答案。")]),key:"0"}:i=="TEXT EMBEDDING"?{name:"title",fn:c(()=>[B("嵌入模型，添加知识库时需要选择嵌入模型，用于将知识库分段向量化。用户提问时也会将问题生成向量，通过比对向量相似度的方式四配跟提问语义相近的知识库分段。向量检索具备很好的语义分析能力。")]),key:"1"}:i=="RERANK"?{name:"title",fn:c(()=>[B("重排序模型,通过重排序模型,将从知识库中检索出来的分段进行重新排序。再将重排序的结果前top-K传递个大语言模型生成答案。重排序有助于优化检索结果，提高大语言模型回答的准确性。")]),key:"2"}:void 0]),1024)]))),128))])]),d("div",Oe,[d("div",qe,y(t.introduce),1)])]),d("div",He,[me(C(p,{class:se({"btn-red":t.listType==1&&_.type==1}),onClick:i=>g(t)},{default:c(()=>[B(y(t.listType==1&&_.type==1?"移除配置":"删除"),1)]),_:2},1032,["class","onClick"]),[[pe,_.type==1]]),_.type==2&&t.model_define!="azure"?(o(),M(p,{key:0,class:"add-btn",onClick:i=>h(t)},{default:c(()=>[B("查看模型")]),_:2},1032,["onClick"])):S("",!0),_.type==2?(o(),M(p,{key:1,disabled:t.listType==1,class:"add-btn",onClick:i=>T(t)},{default:c(()=>[B("添加配置")]),_:2},1032,["disabled","onClick"])):S("",!0),t.listType==1&&_.type==1?(o(),r(A,{key:2},[t.model_define=="azure"?(o(),r(A,{key:0},[C(p,{class:"add-btn",onClick:i=>h(t)},{default:c(()=>[B(y(b(s)("views.user.model.modelConfigButton"))+"（"+y(t.config_list.length)+"）",1)]),_:2},1032,["onClick"]),C(p,{class:"add-btn",onClick:i=>m(t)},{default:c(()=>[B(y(b(s)("views.user.model.addModelButton")),1)]),_:2},1032,["onClick"])],64)):(o(),r(A,{key:1},[C(p,{class:"add-btn",onClick:i=>k(t)},{default:c(()=>[B(y(b(s)("views.user.model.editModelButton")),1)]),_:2},1032,["onClick"]),C(p,{class:"add-btn",onClick:i=>h(t)},{default:c(()=>[B(y(b(s)("views.user.model.viewModelButton")),1)]),_:2},1032,["onClick"])],64))],64)):S("",!0)])]))),128))])}}},te=O(Ge,[["__scopeId","data-v-57dc6c55"]]),z={componentType:"input",placeholder:"",defaultValue:""},Xe={componentType:"radio",defaultValue:void 0},Qe={componentType:"select",defaultValue:void 0},le={id:{hidden:!0},model_types:{...Xe,key:"model_types",label:"模型类型",optionsKey:"supported_type",options:[],disabled:!1,rules:[{required:!0,message:"请选择模型类型",trigger:"change"}]},deployment_name:{...z,label:"部署名称",placeholder:"请与Azure 部署名称保持一致",rules:[{required:!0,message:"请输入部署名称",trigger:"change"}]},api_endpoint:{...z,label:"API 域名",placeholder:"请输入您的API 域名",rules:[{required:!0,message:"请输入API 域名",trigger:"change"}]},api_key:{...z,label:"API Key",placeholder:"请输入您的API Key",rules:[{required:!0,message:"请输入API Key",trigger:"change"}]},secret_key:{...z,label:"Secret Key",placeholder:"请输入您的Secret Key",rules:[{required:!0,message:"请输入Secret Key",trigger:"change"}]},api_version:{...Qe,label:"API 版本",placeholder:"请输入您的API 版本",optionsKey:"api_versions",options:[],rules:[{required:!0,message:"请选择API 版本",trigger:"change"}]}};function We(n){if(le[n])return le[n];let u={...z};return u.placeholder="请输入您的"+n,u}const Ye={columns:[{title:"模型名称",dataIndex:"model_name",key:"model_name",langKey:"views.user.model.model_name"},{title:"模型类型",dataIndex:"model_type",key:"model_type",langKey:"views.user.model.model_type"}],rows:[],showAddBtn:!1},Ze={azure:{columns:[{title:"部署名称",dataIndex:"deployment_name",key:"deployment_name",langKey:"views.user.model.deployment_name"},{title:"模型类型",dataIndex:"model_types",key:"model_types",langKey:"views.user.model.model_types"},{title:"API版本",dataIndex:"api_version",key:"api_version",langKey:"views.user.model.api_version"},{title:"操作",dataIndex:"action",key:"action",width:150,langKey:"common.action"}],rows:[],showAddBtn:!0}};function je(n){if(n.model_define=="azure")return n.config_list;{let u=[];return n.llm_model_list||(n.llm_model_list=[]),n.llm_model_list.forEach(s=>{u.push({model_name:s,model_type:"LLM"})}),n.vector_model_list||(n.vector_model_list=[]),n.vector_model_list.forEach(s=>{u.push({model_name:s,model_type:"TEXT EMBEDDING"})}),u}}function Je(n){let u=["model_define","model_icon_url"],s=Ze[n.model_define];return s||(s=Ye),u.forEach(a=>{s[a]=n[a]}),s.rows=je(n),s}const eo={class:"form-wrapper"},oo={class:"model-logo-box"},to=["src"],lo={class:"form-box"},no={class:"form-item-label"},so=["href"],ao={__name:"set-model-alert",emits:["ok"],setup(n,{expose:u,emit:s}){const{t:a}=q(),_=s,h=oe.useForm,k=I(""),m=ae({model_icon_url:"",model_define:"",model_name:""}),T=I(!1),g=I({}),l=I({}),$=I([]),L=(f,D)=>{g.value={},l.value={},$.value=[];const{model_icon_url:W,model_define:Y,config_params:G,model_name:F}=f;k.value=D?a("common.edit")+" "+F:a("common.add")+" "+F,m.model_icon_url=W,m.model_define=Y,m.model_name=F;let X={},U={},Q=[];G.unshift("id"),G.forEach(K=>{K=="model_type"&&(K="model_types");let e=We(K);e.key=K,e.help_links=f.help_links,e.disabled=!1,e.key=="model_types"&&D&&(e.disabled=!0);let w=e.options;D?U[K]=D[K]||void 0:U[K]=e.defaultValue,e.optionsKey&&f[e.optionsKey]&&(w=f[e.optionsKey]),e.hidden||Q.push({...e,options:w,key:K}),e.rules&&(X[K]=e.rules)}),g.value=X,l.value=U,$.value=Q,T.value=!0,setTimeout(()=>{t()},100)},{resetFields:p,clearValidate:t,validate:i,validateInfos:v}=h(l,g),x=()=>{i().then(()=>{l.value.id?H():P()}).catch(f=>{})},R=()=>{p(),t()},E=I(!1),P=()=>{let f=N(l.value);f.model_type=f.model_types,f.model_define=m.model_define,E.value=!0,ie(f).then(()=>{E.value=!1,T.value=!1,j.success(a("common.saveSuccess")),_("ok")}).catch(()=>{E.value=!1})},H=()=>{let f=N(l.value);f.model_type=f.model_types,f.model_define=m.model_define,E.value=!0,ce(f).then(()=>{E.value=!1,T.value=!1,j.success(a("common.saveSuccess")),_("ok")}).catch(()=>{E.value=!1})};return u({open:L}),(f,D)=>{const W=be,Y=Ce,G=Me,F=Ae,X=Te,U=we,Q=oe,K=J;return o(),M(K,{class:"add-model-alert",width:"650px",open:T.value,"onUpdate:open":D[0]||(D[0]=e=>T.value=e),title:k.value,confirmLoading:E.value,onOk:x,onCancel:R},{default:c(()=>[d("div",eo,[d("div",oo,[d("img",{class:"model-logo",src:m.model_icon_url,alt:""},null,8,to)]),d("div",lo,[C(Q,{layout:"horizontal","label-col":{span:6},"wrapper-col":{span:18}},{default:c(()=>[(o(!0),r(A,null,V($.value,e=>(o(),r(A,{key:e.key},[e.hidden?S("",!0):(o(),M(U,ye(he({key:0},b(v)[e.key])),{label:c(()=>[d("div",no,[d("span",null,y(b(a)("views.user.model."+e.key)),1)])]),default:c(()=>[e.componentType=="radio"?(o(),M(Y,{key:0,value:l.value[e.key],"onUpdate:value":w=>l.value[e.key]=w,disabled:e.disabled},{default:c(()=>[(o(!0),r(A,null,V(e.options,(w,Z)=>(o(),M(W,{value:w,key:Z},{default:c(()=>[d("span",null,y(w),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","disabled"])):S("",!0),e.componentType=="select"?(o(),M(F,{key:1,value:l.value[e.key],"onUpdate:value":w=>l.value[e.key]=w,placeholder:e.placeholder},{default:c(()=>[(o(!0),r(A,null,V(e.options,(w,Z)=>(o(),M(G,{value:w,key:Z},{default:c(()=>[d("span",null,y(w),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder"])):S("",!0),e.componentType=="input"?(o(),r(A,{key:2},[C(X,{value:l.value[e.key],"onUpdate:value":w=>l.value[e.key]=w,placeholder:e.placeholder},null,8,["value","onUpdate:value","placeholder"]),e.key=="api_key"?(o(),r("a",{key:0,href:e.help_links,target:"_blank"},y(b(a)("views.user.model.getApikeyText")),9,so)):S("",!0)],64)):S("",!0)]),_:2},1040))],64))),128))]),_:1})])])]),_:1},8,["open","title","confirmLoading"])}}},io=O(ao,[["__scopeId","data-v-d94c3f9a"]]),co={class:"form-wrapper"},ro={class:"tools-wrapper"},uo=["src"],_o={class:"tools-box"},mo={class:"list-box"},po=["onClick"],vo=["onClick"],fo={__name:"see-model-alert",emits:["new","edit","remove"],setup(n,{expose:u,emit:s}){const{t:a}=q(),_=s,h=I(!1),k=ae({model_icon_url:"",model_define:"",columns:[],rows:[],showAddBtn:!1});let m=ge({});const T=p=>{m=p;let t=Je(p);for(let i in t)k[i]=t[i];h.value=!0},g=()=>{h.value=!1,_("new",{...m})},l=p=>{h.value=!1,_("edit",{...m},N(p))},$=p=>{h.value=!1,_("remove",N(p))},L=()=>{};return u({open:T}),(p,t)=>{const i=ne,v=$e,x=xe,R=Ie,E=J;return o(),M(E,{class:"add-model-alert",width:"800px",open:h.value,"onUpdate:open":t[0]||(t[0]=P=>h.value=P),title:b(a)("views.user.model.modelConfigButton"),footer:null,onOk:L},{default:c(()=>[d("div",co,[d("div",ro,[d("img",{class:"model-logo",src:k.model_icon_url,alt:""},null,8,uo),d("div",_o,[k.showAddBtn?(o(),M(i,{key:0,type:"primary",onClick:g},{default:c(()=>[B(y(b(a)("views.user.model.addModel")),1)]),_:1})):S("",!0)])]),d("div",mo,[C(R,{"data-source":k.rows,scroll:{y:400},pagination:!1},{default:c(()=>[(o(!0),r(A,null,V(k.columns,P=>(o(),r(A,{key:P.key},[P.key=="action"?(o(),M(x,{key:0,title:b(a)("common.action"),"data-index":P.key,width:"140px"},{default:c(({record:H})=>[d("span",null,[d("a",{onClick:f=>l(H)},y(b(a)("common.edit")),9,po),C(v,{type:"vertical"}),d("a",{onClick:f=>$(H)},y(b(a)("common.remove")),9,vo)])]),_:2},1032,["title","data-index"])):(o(),M(x,{key:1,title:b(a)("views.user.model."+P.key),"data-index":P.key},null,8,["title","data-index"]))],64))),128))]),_:1},8,["data-source"])])])]),_:1},8,["open","title"])}}},yo=O(fo,[["__scopeId","data-v-d5400788"]]),ho={class:"user-model-page"},go={class:"list-wrapper"},ko={__name:"index",setup(n){const{t:u}=q(),s=I(1),a=()=>{},_=I([]),h=ee(()=>_.value.filter(v=>v.listType==1)),k=ee(()=>_.value),m=()=>{re().then(v=>{let x=v.data||[];x.forEach(R=>{R.listType=R.config_list.length>0?1:0}),x.sort((R,E)=>R.listType-E.listType),_.value=x})};m();const T=I(null),g=v=>{T.value.open(v)},l=v=>{L.value.open(v)},$=v=>{L.value.open(v)},L=I(null),p=(v,x)=>{L.value.open(v,x)},t=()=>{m()},i=v=>{J.confirm({title:u("views.user.model.deleteModel"),icon:C(de),content:u("views.user.model.deleteModelContent"),onOk(){ue({id:v.id}).then(()=>{j.success(u("common.deleteSuccessful")),m()})}})};return(v,x)=>(o(),r(A,null,[d("div",ho,[C(Be,{value:s.value,"onUpdate:value":x[0]||(x[0]=R=>s.value=R),onChange:a},null,8,["value"]),d("div",go,[s.value==1?(o(),M(te,{list:h.value,type:1,key:"addedModelList",onEdit:p,onNew:l,onSee:g,onRemove:i},null,8,["list"])):S("",!0),s.value==0?(o(),M(te,{list:k.value,type:2,key:"canAddModelList",onAdd:$,onSee:g},null,8,["list"])):S("",!0)])]),C(yo,{ref_key:"seeModelAlertRef",ref:T,onNew:l,onEdit:p,onRemove:i},null,512),C(io,{ref_key:"setModelAlertRef",ref:L,onOk:t},null,512)],64))}},Jo=O(ko,[["__scopeId","data-v-290d7cb8"]]);export{Jo as default};
