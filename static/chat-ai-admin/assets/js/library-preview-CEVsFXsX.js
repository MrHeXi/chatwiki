function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/js/vue-pdf-embed-DLTanxCR.js","assets/js/vue-chunks-Chs-lyDX.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{K as pe,N as ve,bK as _e,O as J,P as he,R as se,S as ie,X as Q,bc as ge,a2 as ee,ai as fe,T as me,_ as z,d as B,M as re,E as be,f as $e}from"../../index.js";import{f as ce,b as L,k as p,s as Ce,j as ye,F as q,M as f,N as y,a4 as Y,a5 as Z,W as l,e as $,S as E,Y as V,Z as I,a2 as Se,a8 as te,a9 as X,a1 as xe,a0 as ke,u as oe,Q as R,ak as Ie,z as Pe}from"./vue-chunks-Chs-lyDX.js";import{n as we,o as Te,b as Ee,p as Le}from"./index-DByfIRTu.js";import"./index-9H-48H6s.js";import{I as He}from"./Password-cmG-BlhH.js";import{_ as De}from"./TextArea-DvaABMYL.js";import{C as ae}from"./cu-scroll-Dlyosbal.js";import{u as Be,v as Me,w as qe,_ as ze}from"./index-DBNqHYGh.js";import{L as Ae}from"./LeftOutlined-DnP_dahC.js";import{S as Fe}from"./index-B8boHKw3.js";import"./dayjs-CkLU8sYs.js";import"./axios-Cm0UX6qg.js";import"./qs-DjYKlG5V.js";import"./crypto-js-BUUKnz8c.js";import"./inputProps-DYO7gEw-.js";import"./index-CwZHIw9t.js";const N=(e,h,o)=>{const i=_e(o);return{[`${e.componentCls}-${h}`]:{color:e[`color${o}`],background:e[`color${i}Bg`],borderColor:e[`color${i}Border`],[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}},Oe=e=>Be(e,(h,o)=>{let{textColor:i,lightBorderColor:a,lightColor:t,darkColor:s}=o;return{[`${e.componentCls}-${h}`]:{color:i,background:t,borderColor:a,"&-inverse":{color:e.colorTextLightSolid,background:s,borderColor:s},[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}}),Re=e=>{const{paddingXXS:h,lineWidth:o,tagPaddingHorizontal:i,componentCls:a}=e,t=i-o,s=h-o;return{[a]:J(J({},he(e)),{display:"inline-block",height:"auto",marginInlineEnd:e.marginXS,paddingInline:t,fontSize:e.tagFontSize,lineHeight:`${e.tagLineHeight}px`,whiteSpace:"nowrap",background:e.tagDefaultBg,border:`${e.lineWidth}px ${e.lineType} ${e.colorBorder}`,borderRadius:e.borderRadiusSM,opacity:1,transition:`all ${e.motionDurationMid}`,textAlign:"start",[`&${a}-rtl`]:{direction:"rtl"},"&, a, a:hover":{color:e.tagDefaultColor},[`${a}-close-icon`]:{marginInlineStart:s,color:e.colorTextDescription,fontSize:e.tagIconSize,cursor:"pointer",transition:`all ${e.motionDurationMid}`,"&:hover":{color:e.colorTextHeading}},[`&${a}-has-color`]:{borderColor:"transparent",[`&, a, a:hover, ${e.iconCls}-close, ${e.iconCls}-close:hover`]:{color:e.colorTextLightSolid}},"&-checkable":{backgroundColor:"transparent",borderColor:"transparent",cursor:"pointer",[`&:not(${a}-checkable-checked):hover`]:{color:e.colorPrimary,backgroundColor:e.colorFillSecondary},"&:active, &-checked":{color:e.colorTextLightSolid},"&-checked":{backgroundColor:e.colorPrimary,"&:hover":{backgroundColor:e.colorPrimaryHover}},"&:active":{backgroundColor:e.colorPrimaryActive}},"&-hidden":{display:"none"},[`> ${e.iconCls} + span, > span + ${e.iconCls}`]:{marginInlineStart:t}}),[`${a}-borderless`]:{borderColor:"transparent",background:e.tagBorderlessBg}}},de=pe("Tag",e=>{const{fontSize:h,lineHeight:o,lineWidth:i,fontSizeIcon:a}=e,t=Math.round(h*o),s=e.fontSizeSM,m=t-i*2,b=e.colorFillAlter,u=e.colorText,r=ve(e,{tagFontSize:s,tagLineHeight:m,tagDefaultBg:b,tagDefaultColor:u,tagIconSize:a-2*i,tagPaddingHorizontal:8,tagBorderlessBg:e.colorFillTertiary});return[Re(r),Oe(r),N(r,"success","Success"),N(r,"processing","Info"),N(r,"error","Error"),N(r,"warning","Warning")]}),Ne=()=>({prefixCls:String,checked:{type:Boolean,default:void 0},onChange:{type:Function},onClick:{type:Function},"onUpdate:checked":Function}),Qe=ce({compatConfig:{MODE:3},name:"ACheckableTag",inheritAttrs:!1,props:Ne(),setup(e,h){let{slots:o,emit:i,attrs:a}=h;const{prefixCls:t}=se("tag",e),[s,m]=de(t),b=r=>{const{checked:n}=e;i("update:checked",!n),i("change",!n),i("click",r)},u=L(()=>ie(t.value,m.value,{[`${t.value}-checkable`]:!0,[`${t.value}-checkable-checked`]:e.checked}));return()=>{var r;return s(p("span",Q(Q({},a),{},{class:[u.value,a.class],onClick:b}),[(r=o.default)===null||r===void 0?void 0:r.call(o)]))}}}),K=Qe,Ue=()=>({prefixCls:String,color:{type:String},closable:{type:Boolean,default:!1},closeIcon:ee.any,visible:{type:Boolean,default:void 0},onClose:{type:Function},onClick:fe(),"onUpdate:visible":Function,icon:ee.any,bordered:{type:Boolean,default:!0}}),M=ce({compatConfig:{MODE:3},name:"ATag",inheritAttrs:!1,props:Ue(),slots:Object,setup(e,h){let{slots:o,emit:i,attrs:a}=h;const{prefixCls:t,direction:s}=se("tag",e),[m,b]=de(t),u=Ce(!0);ye(()=>{e.visible!==void 0&&(u.value=e.visible)});const r=d=>{d.stopPropagation(),i("update:visible",!1),i("close",d),!d.defaultPrevented&&e.visible===void 0&&(u.value=!1)},n=L(()=>Me(e.color)||qe(e.color)),g=L(()=>ie(t.value,b.value,{[`${t.value}-${e.color}`]:n.value,[`${t.value}-has-color`]:e.color&&!n.value,[`${t.value}-hidden`]:!u.value,[`${t.value}-rtl`]:s.value==="rtl",[`${t.value}-borderless`]:!e.bordered})),k=d=>{i("click",d)};return()=>{var d,_,P;const{icon:w=(d=o.icon)===null||d===void 0?void 0:d.call(o),color:T,closeIcon:S=(_=o.closeIcon)===null||_===void 0?void 0:_.call(o),closable:A=!1}=e,W=()=>A?S?p("span",{class:`${t.value}-close-icon`,onClick:r},[S]):p(me,{class:`${t.value}-close-icon`,onClick:r},null):null,H={backgroundColor:T&&!n.value?T:void 0},D=w||null,F=(P=o.default)===null||P===void 0?void 0:P.call(o),c=D?p(q,null,[D,p("span",null,[F])]):F,v=e.onClick!==void 0,C=p("span",Q(Q({},a),{},{onClick:k,class:[g.value,a.class],style:[H,a.style]}),[c,W()]);return m(v?p(ge,null,{default:()=>[C]}):C)}}});M.CheckableTag=K;M.install=function(e){return e.component(M.name,M),e.component(K.name,K),e};const We=M,je="/assets/img/empty-oK82-lgD.png",Ve={},ue=e=>(Y("data-v-fabdb138"),e=e(),Z(),e),Xe={class:"empty-box"},Ke=ue(()=>l("img",{src:je,alt:""},null,-1)),Ye=ue(()=>l("div",{class:"title"},"未完成学习，无法查看分段",-1)),Ze=[Ke,Ye];function Ge(e,h){return f(),y("div",Xe,Ze)}const le=z(Ve,[["render",Ge],["__scopeId","data-v-fabdb138"]]),U=e=>(Y("data-v-f1a9f82c"),e=e(),Z(),e),Je={class:"form-box-wrapper"},et={class:"form-item"},tt=U(()=>l("div",{class:"form-label"},"分段标题：",-1)),ot={class:"form-content"},at={class:"form-item"},lt=U(()=>l("div",{class:"form-label"},"分段问题：",-1)),nt={class:"form-content"},st={class:"form-item"},it=U(()=>l("div",{class:"form-label"},"分段答案：",-1)),rt={class:"form-content"},ct={key:1,class:"form-item"},dt=U(()=>l("div",{class:"form-label required"},"分段内容：",-1)),ut={class:"form-content"},pt={__name:"edit-subsection",emits:["handleEdit"],setup(e,{expose:h,emit:o}){const i=o,a=$(!1),t=$(""),s=$(""),m=$(""),b=$(""),u=$(""),r=$({}),n=$(!1),g=d=>{r.value=d,t.value=d.title,s.value=d.content,u.value=d.id,m.value=d.answer,b.value=d.question,n.value=d.isExcelQa,a.value=!0},k=()=>{if(!s.value&&!n.value)return B.error("请输入分段内容");if(!b.value&&n.value)return B.error("请输入分段问题");if(!m.value&&n.value)return B.error("请输入分段答案");let d={title:t.value,content:s.value,id:u.value,question:b.value,answer:m.value};we(d).then(_=>{B.success("修改成功"),a.value=!1,i("handleEdit",d)})};return h({showModal:g}),(d,_)=>{const P=He,w=De,T=re;return f(),y("div",null,[p(T,{open:a.value,"onUpdate:open":_[4]||(_[4]=S=>a.value=S),title:"编辑分段",onOk:k,width:"746px"},{default:E(()=>[l("div",Je,[l("div",et,[tt,l("div",ot,[p(P,{value:t.value,"onUpdate:value":_[0]||(_[0]=S=>t.value=S),placeholder:"请输入分段标题"},null,8,["value"])])]),n.value?(f(),y(q,{key:0},[l("div",at,[lt,l("div",nt,[p(w,{placeholder:"请输入分段问题",value:b.value,"onUpdate:value":_[1]||(_[1]=S=>b.value=S),style:{height:"100px"}},null,8,["value"])])]),l("div",st,[it,l("div",rt,[p(w,{placeholder:"请输入分段答案",value:m.value,"onUpdate:value":_[2]||(_[2]=S=>m.value=S),style:{height:"250px"}},null,8,["value"])])])],64)):(f(),y("div",ct,[dt,l("div",ut,[p(w,{style:{height:"450px"},value:s.value,"onUpdate:value":_[3]||(_[3]=S=>s.value=S),placeholder:"请输入分段内容"},null,8,["value"])])]))])]),_:1},8,["open"])])}}},vt=z(pt,[["__scopeId","data-v-f1a9f82c"]]),_t=e=>(Y("data-v-e107f467"),e=e(),Z(),e),ht={class:"subsection-box"},gt={class:"subsection-box-title"},ft=["onClick"],mt={class:"top-block"},bt={class:"title"},$t={class:"right-opration"},Ct=["onClick"],yt=_t(()=>l("span",{class:"v-line"},null,-1)),St=["onClick"],xt={key:0,class:"content-box"},kt={key:1,class:"content-box"},It=["innerHTML"],Pt={__name:"subsection-box",props:{paragraphLists:{type:Array,default:()=>[]},total:{type:[Number,String],default:0}},emits:["handleEditParagraph","handleDelParagraph","handleScrollTargetPage"],setup(e,{emit:h}){const o=h,i=e,a=$(null),t=u=>{a.value.showModal(u)},s=u=>{o("handleEditParagraph",u)},m=u=>{re.confirm({title:"提示",icon:p(be),content:"确认是否删除该分段?",onOk(){return new Promise((r,n)=>{Te({id:u}).then(g=>{B.success("删除成功"),o("handleDelParagraph",u),r()}).catch(()=>{r()})})},onCancel(){}})},b=u=>{o("handleScrollTargetPage",u)};return(u,r)=>(f(),y("div",ht,[l("div",gt,[V(" 分段预览 "),l("span",null,"共"+I(i.total)+"个分段",1)]),(f(!0),y(q,null,Se(i.paragraphLists,n=>(f(),y("div",{onClick:g=>b(n.page_num),class:"list-item",key:n.id},[l("div",mt,[l("div",bt,[V(" id："+I(n.id)+" "+I(n.title)+" ",1),l("span",null,"共"+I(n.word_total)+"个字符",1),l("span",null,"状态："+I(n.status_text),1)]),l("div",$t,[l("a",{onClick:te(g=>t(n),["stop"])},"编辑",8,Ct),yt,l("a",{onClick:te(g=>m(n.id),["stop"])},"删除",8,St)])]),n.question?(f(),y("div",xt,"Q："+I(n.question),1)):X("",!0),n.answer?(f(),y("div",kt,"A："+I(n.answer),1)):X("",!0),l("div",{class:"content-box",innerHTML:n.content},null,8,It)],8,ft))),128)),p(vt,{onHandleEdit:s,ref_key:"editSubscription",ref:a},null,512)]))}},ne=z(Pt,[["__scopeId","data-v-e107f467"]]),wt={class:"mode-box"},Tt=["innerHTML"],Et={__name:"segmentation-mode",props:{detailsInfo:{type:Object}},setup(e){const h=e,o=$(""),i=L(()=>{const{is_table_file:a,is_qa_doc:t,is_diy_split:s,question_lable:m,answer_lable:b,separators:u,chunk_size:r,chunk_overlap:n,question_column:g,answer_column:k,qa_index_type:d}=h.detailsInfo;if(a!=1&&t!=1&&s!=1)return o.value=`分段模式：智能分段
文档类型：普通文档`,"智能分段：普通文档";if(a!=1&&t==1)return o.value=`分段模式：智能分段
文档类型：QA文档
问题开始标识符："${m}"
答案开始标识符："${b}"`,"智能分段：QA文档";if(a!=1&&t!=1&&s==1)return o.value=`分段模式：自定义分段
文档标识符：${u}
分段最大长度：${r}字符
文段重叠长度：${n}字符`,"自定义分段";if(a==1&&t!=1)return o.value=`分段模式：智能分段
文档类型：普通表格`,"智能分段：普通表格";if(a==1&&t==1){let _=d==1?"问题与答案一起生成索引":"仅对问题生成索引";return o.value=`分段模式：智能分段
文档类型：QA文档
问题所在列："${g}"
答案所在列："${k}"
索引方式：${_}`,"智能分段：QA文档"}});return(a,t)=>{const s=We,m=ze;return f(),y("div",wt,[p(m,null,{title:E(()=>[l("div",{class:"tooltip-text-box",innerHTML:o.value},null,8,Tt)]),default:E(()=>[p(s,{color:"#2db7f5"},{default:E(()=>[V(I(i.value),1)]),_:1})]),_:1})])}}},Lt=z(Et,[["__scopeId","data-v-df11edaf"]]),Ht={class:"library-preview-page"},Dt={class:"document-title-block"},Bt={class:"title"},Mt={key:0,class:"page-loading-box"},qt={class:"content-block"},zt={key:1,class:"pdf-view-box"},At={class:"view-content-wrap"},Ft={key:0,class:"loading-box"},Ot={class:"view-content"},Rt={class:"right-contnt-box"},Nt={class:"content-block"},Qt={__name:"library-preview",setup(e){const h=Ie(()=>$e(()=>import("./vue-pdf-embed-DLTanxCR.js").then(c=>c.v),__vite__mapDeps([0,1]))),o=xe(),i=ke(),a=L(()=>s.value.is_qa_doc=="1"),t=L(()=>{let c=s.value.status;return!(c=="1"||c=="2")||g.value.length==0}),s=$({pdf_url:""}),m=()=>{i.back()},b=$(!0);(async()=>{Ee({id:o.query.id}).then(c=>{s.value=c.data;let v=c.data.status;v==1||v==2?P():b.value=!1})})();const r=$({page:1,size:10}),n=$({}),g=$([]),k=$(0),d={0:"未转换",1:"已转换",2:"转换异常"};let _=!0;const P=()=>{_=!0,Le({file_id:o.query.id,...r.value}).then(c=>{var O,G;b.value=!1,_=!1;let v=c.data,C=v.list||[],x=((O=v.info)==null?void 0:O.is_qa_doc)=="1"&&((G=v.info)==null?void 0:G.is_table_file)=="1";C.forEach(j=>{j.status_text=d[j.status],j.isExcelQa=x}),n.value=v.info,g.value=[...g.value,...C],k.value=v.total})},w=()=>{_||g.value.length>=k.value||(r.value.page++,P())},T=c=>{let v=g.value,C=v.findIndex(x=>x.id==c.id);if(C>-1){let x=v[C];x.title=c.title,x.content=c.content,x.question=c.question,x.answer=c.answer,x.word_total=c.question.length+c.answer.length+c.content.length,v.splice(C,1,x),g.value=v}},S=c=>{let v=g.value,C=v.findIndex(x=>x.id==c);C>-1&&(v.splice(C,1),g.value=v,k.value=k.value--)},A=$(!0),W=c=>{A.value=!1},H=$(null),D=$(null),F=async c=>{await Pe();let v=H.value.pageCount,x=H.value.$el.offsetHeight/v,O=(c-1)*x;D.value.scrollTop=O};return(c,v)=>{const C=Fe;return f(),y("div",Ht,[l("div",Dt,[p(oe(Ae),{onClick:m}),l("span",Bt,I(s.value.file_name),1),p(Lt,{detailsInfo:s.value},null,8,["detailsInfo"])]),b.value?(f(),y("div",Mt,[p(C)])):(f(),y(q,{key:1},[a.value?(f(),y(q,{key:0},[t.value?(f(),R(le,{key:0})):(f(),R(ae,{key:1,onOnScrollEnd:w},{default:E(()=>[l("div",qt,[p(ne,{total:k.value,paragraphLists:g.value,onHandleEditParagraph:T,onHandleDelParagraph:S},null,8,["total","paragraphLists"])])]),_:1}))],64)):(f(),y("div",zt,[l("div",At,[l("div",{class:"view-gray-bg",ref_key:"scollDivRef",ref:D},[A.value?(f(),y("div",Ft,[p(C)])):X("",!0),l("div",Ot,[p(oe(h),{ref_key:"vuePdfRef",ref:H,onLoaded:W,source:s.value.pdf_url},null,8,["source"])])],512)]),l("div",Rt,[t.value?(f(),R(le,{key:0})):(f(),R(ae,{key:1,onOnScrollEnd:w},{default:E(()=>[l("div",Nt,[p(ne,{total:k.value,paragraphLists:g.value,onHandleEditParagraph:T,onHandleDelParagraph:S,onHandleScrollTargetPage:F},null,8,["total","paragraphLists"])])]),_:1}))])]))],64))])}}},so=z(Qt,[["__scopeId","data-v-d77efbcf"]]);export{so as default};
