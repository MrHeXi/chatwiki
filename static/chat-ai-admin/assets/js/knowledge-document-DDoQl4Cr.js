import{C as xe}from"./cu-scroll-Dlyosbal.js";import{f as ie,e as D,b as V,k as s,F as Y,ag as ke,a1 as Pe,a0 as Se,B as ee,M as $,N as B,S as w,aa as $e,W as C,u as W,Z as te,a9 as O,Y as H,Q as we,a4 as Be,a5 as Oe}from"./vue-chunks-Chs-lyDX.js";import{K as se,N as ze,ay as Ie,O as f,P as Te,H as re,a8 as ce,al as pe,R as ue,S as de,X as A,ab as me,a6 as fe,as as z,av as oe,az as Le,aA as Fe,aB as Ne,ap as De,a3 as ne,$ as Ae,aC as ae,B as ge,aD as je,a7 as Me,A as Ee,_ as Re,an as We,o as He,d as U,M as Ue,Y as qe,C as Ve}from"../../index.js";import{i as Ye,j as Xe,k as Qe}from"./index-DByfIRTu.js";import{U as Ze}from"./upload-input-DzWNjCY0.js";/* empty css                                                                       *//* empty css                                                                         */import"./index-9H-48H6s.js";import{I as Ge}from"./Password-cmG-BlhH.js";import{S as Je}from"./index-B8boHKw3.js";import{g as Ke,P as et,t as ve,_ as _e,a as ye}from"./index-DBNqHYGh.js";import{u as tt}from"./CheckOutlined-D4HtVfaw.js";import{P as ot}from"./PlusOutlined-BUnPSW1-.js";import{S as nt}from"./TextArea-DvaABMYL.js";import{_ as at}from"./index-DOqSVN3l.js";import{a as lt}from"./index-DP_X7UEl.js";import"./dayjs-CkLU8sYs.js";import"./axios-Cm0UX6qg.js";import"./qs-DjYKlG5V.js";import"./crypto-js-BUUKnz8c.js";import"./index-DHBKO1se.js";import"./index-VeYSCPCu.js";import"./Col-CvDsueo7.js";import"./collapseMotion-DN2MDQ98.js";import"./QuestionCircleOutlined-B0hVewZq.js";import"./inputProps-DYO7gEw-.js";import"./index-CwZHIw9t.js";import"./LeftOutlined-DnP_dahC.js";import"./RightOutlined-BSM_93j-.js";import"./index-MD3V6K2I.js";import"./slide-CP07UJ8x.js";import"./DownOutlined-DRniQ56W.js";import"./move-DwQ0mPkQ.js";import"./index-DdoCKw3y.js";import"./index-B7-ex2lw.js";import"./index-Bz3n5ObF.js";import"./dropdown-T3bZiTSp.js";import"./index-C9DKKAWk.js";const it=e=>{const{componentCls:t,popoverBg:o,popoverColor:n,width:l,fontWeightStrong:_,popoverPadding:a,boxShadowSecondary:m,colorTextHeading:x,borderRadiusLG:y,zIndexPopup:k,marginXS:P,colorBgElevated:u}=e;return[{[t]:f(f({},Te(e)),{position:"absolute",top:0,left:{_skip_check_:!0,value:0},zIndex:k,fontWeight:"normal",whiteSpace:"normal",textAlign:"start",cursor:"auto",userSelect:"text","--antd-arrow-background-color":u,"&-rtl":{direction:"rtl"},"&-hidden":{display:"none"},[`${t}-content`]:{position:"relative"},[`${t}-inner`]:{backgroundColor:o,backgroundClip:"padding-box",borderRadius:y,boxShadow:m,padding:a},[`${t}-title`]:{minWidth:l,marginBottom:P,color:x,fontWeight:_},[`${t}-inner-content`]:{color:n}})},Ke(e,{colorBg:"var(--antd-arrow-background-color)"}),{[`${t}-pure`]:{position:"relative",maxWidth:"none",[`${t}-content`]:{display:"inline-block"}}}]},st=e=>{const{componentCls:t}=e;return{[t]:et.map(o=>{const n=e[`${o}-6`];return{[`&${t}-${o}`]:{"--antd-arrow-background-color":n,[`${t}-inner`]:{backgroundColor:n},[`${t}-arrow`]:{background:"transparent"}}}})}},rt=e=>{const{componentCls:t,lineWidth:o,lineType:n,colorSplit:l,paddingSM:_,controlHeight:a,fontSize:m,lineHeight:x,padding:y}=e,k=a-Math.round(m*x),P=k/2,u=k/2-o,d=y;return{[t]:{[`${t}-inner`]:{padding:0},[`${t}-title`]:{margin:0,padding:`${P}px ${d}px ${u}px`,borderBottom:`${o}px ${n} ${l}`},[`${t}-inner-content`]:{padding:`${_}px ${d}px`}}}},ct=se("Popover",e=>{const{colorBgElevated:t,colorText:o,wireframe:n}=e,l=ze(e,{popoverBg:t,popoverColor:o,popoverPadding:12});return[it(l),st(l),n&&rt(l),Ie(l,"zoom-big")]},e=>{let{zIndexPopupBase:t}=e;return{zIndexPopup:t+30,width:177}}),pt=()=>f(f({},ye()),{content:z(),title:z()}),ut=ie({compatConfig:{MODE:3},name:"APopover",inheritAttrs:!1,props:ce(pt(),f(f({},ve()),{trigger:"hover",placement:"top",mouseEnterDelay:.1,mouseLeaveDelay:.1})),setup(e,t){let{expose:o,slots:n,attrs:l}=t;const _=D();pe(e.visible===void 0),o({getPopupDomNode:()=>{var u,d;return(d=(u=_.value)===null||u===void 0?void 0:u.getPopupDomNode)===null||d===void 0?void 0:d.call(u)}});const{prefixCls:a,configProvider:m}=ue("popover",e),[x,y]=ct(a),k=V(()=>m.getPrefixCls()),P=()=>{var u,d;const{title:r=oe((u=n.title)===null||u===void 0?void 0:u.call(n)),content:g=oe((d=n.content)===null||d===void 0?void 0:d.call(n))}=e,I=!!(Array.isArray(r)?r.length:r),j=!!(Array.isArray(g)?g.length:r);return!I&&!j?null:s(Y,null,[I&&s("div",{class:`${a.value}-title`},[r]),s("div",{class:`${a.value}-inner-content`},[g])])};return()=>{const u=de(e.overlayClassName,y.value);return x(s(_e,A(A(A({},fe(e,["title","content"])),l),{},{prefixCls:a.value,ref:_,overlayClassName:u,transitionName:me(k.value,"zoom-big",e.transitionName),"data-popover-inject":!0}),{title:P,default:n.default}))}}}),dt=re(ut),mt=e=>{const{componentCls:t,iconCls:o,zIndexPopup:n,colorText:l,colorWarning:_,marginXS:a,fontSize:m,fontWeightStrong:x,lineHeight:y}=e;return{[t]:{zIndex:n,[`${t}-inner-content`]:{color:l},[`${t}-message`]:{position:"relative",marginBottom:a,color:l,fontSize:m,display:"flex",flexWrap:"nowrap",alignItems:"start",[`> ${t}-message-icon ${o}`]:{color:_,fontSize:m,flex:"none",lineHeight:1,paddingTop:(Math.round(m*y)-m)/2},"&-title":{flex:"auto",marginInlineStart:a},"&-title-only":{fontWeight:x}},[`${t}-description`]:{position:"relative",marginInlineStart:m+a,marginBottom:a,color:l,fontSize:m},[`${t}-buttons`]:{textAlign:"end",button:{marginInlineStart:a}}}}},ft=se("Popconfirm",e=>mt(e),e=>{const{zIndexPopupBase:t}=e;return{zIndexPopup:t+60}});var gt=function(e,t){var o={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,n=Object.getOwnPropertySymbols(e);l<n.length;l++)t.indexOf(n[l])<0&&Object.prototype.propertyIsEnumerable.call(e,n[l])&&(o[n[l]]=e[n[l]]);return o};const vt=()=>f(f({},ye()),{prefixCls:String,content:z(),title:z(),description:z(),okType:De("primary"),disabled:{type:Boolean,default:!1},okText:z(),cancelText:z(),icon:z(),okButtonProps:ne(),cancelButtonProps:ne(),showCancel:{type:Boolean,default:!0},onConfirm:Function,onCancel:Function}),_t=ie({compatConfig:{MODE:3},name:"APopconfirm",inheritAttrs:!1,props:ce(vt(),f(f({},ve()),{trigger:"click",placement:"top",mouseEnterDelay:.1,mouseLeaveDelay:.1,arrowPointAtCenter:!1,autoAdjustOverflow:!0,okType:"primary",disabled:!1})),slots:Object,setup(e,t){let{slots:o,emit:n,expose:l,attrs:_}=t;const a=D();pe(e.visible===void 0),l({getPopupDomNode:()=>{var i,c;return(c=(i=a.value)===null||i===void 0?void 0:i.getPopupDomNode)===null||c===void 0?void 0:c.call(i)}});const[m,x]=tt(!1,{value:ke(e,"open")}),y=(i,c)=>{e.open===void 0&&x(i),n("update:open",i),n("openChange",i,c)},k=i=>{y(!1,i)},P=i=>{var c;return(c=e.onConfirm)===null||c===void 0?void 0:c.call(e,i)},u=i=>{var c;y(!1,i),(c=e.onCancel)===null||c===void 0||c.call(e,i)},d=i=>{i.keyCode===Me.ESC&&m&&y(!1,i)},r=i=>{const{disabled:c}=e;c||y(i)},{prefixCls:g,getPrefixCls:I}=ue("popconfirm",e),j=V(()=>I()),q=V(()=>I("btn")),[p]=ft(g),[v]=Le("Popconfirm",Fe.Popconfirm),S=()=>{var i,c,T,L,F;const{okButtonProps:N,cancelButtonProps:M,title:E=(i=o.title)===null||i===void 0?void 0:i.call(o),description:h=(c=o.description)===null||c===void 0?void 0:c.call(o),cancelText:b=(T=o.cancel)===null||T===void 0?void 0:T.call(o),okText:R=(L=o.okText)===null||L===void 0?void 0:L.call(o),okType:Q,icon:Z=((F=o.icon)===null||F===void 0?void 0:F.call(o))||s(Ae,null,null),showCancel:he=!0}=e,{cancelButton:G,okButton:J}=o,K=f({onClick:u,size:"small"},M),be=f(f(f({onClick:P},ae(Q)),{size:"small"}),N);return s("div",{class:`${g.value}-inner-content`},[s("div",{class:`${g.value}-message`},[Z&&s("span",{class:`${g.value}-message-icon`},[Z]),s("div",{class:[`${g.value}-message-title`,{[`${g.value}-message-title-only`]:!!h}]},[E])]),h&&s("div",{class:`${g.value}-description`},[h]),s("div",{class:`${g.value}-buttons`},[he?G?G(K):s(ge,K,{default:()=>[b||v.value.cancelText]}):null,J?J(be):s(je,{buttonProps:f(f({size:"small"},ae(Q)),N),actionFn:P,close:k,prefixCls:q.value,quitOnNullishReturnValue:!0,emitEvent:!0},{default:()=>[R||v.value.okText]})])])};return()=>{var i;const{placement:c,overlayClassName:T,trigger:L="click"}=e,F=gt(e,["placement","overlayClassName","trigger"]),N=fe(F,["title","content","cancelText","okText","onUpdate:open","onConfirm","onCancel","prefixCls"]),M=de(g.value,T);return p(s(dt,A(A(A({},N),_),{},{trigger:L,placement:c,onOpenChange:r,open:m.value,overlayClassName:M,transitionName:me(j.value,"zoom-big",e.transitionName),ref:a,"data-popover-inject":!0}),{default:()=>[Ne(((i=o.default)===null||i===void 0?void 0:i.call(o))||[],{onKeydown:E=>{d(E)}},!1)],content:S}))}}}),yt=re(_t);var Ct={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm176.5 585.7l-28.6 39a7.99 7.99 0 01-11.2 1.7L483.3 569.8a7.92 7.92 0 01-3.3-6.5V288c0-4.4 3.6-8 8-8h48.1c4.4 0 8 3.6 8 8v247.5l142.6 103.1c3.6 2.5 4.4 7.5 1.8 11.1z"}}]},name:"clock-circle",theme:"filled"};const ht=Ct;function le(e){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?Object(arguments[t]):{},n=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(o).filter(function(l){return Object.getOwnPropertyDescriptor(o,l).enumerable}))),n.forEach(function(l){bt(e,l,o[l])})}return e}function bt(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var X=function(t,o){var n=le({},t,o.attrs);return s(Ee,le({},n,{icon:ht}),null)};X.displayName="ClockCircleFilled";X.inheritAttrs=!1;const xt=X,Ce=e=>(Be("data-v-4b1314aa"),e=e(),Oe(),e),kt={class:"details-library-page"},Pt={class:"list-tools"},St={class:"tool-item"},$t=Ce(()=>C("span",null,"上传文档",-1)),wt={class:"tool-item"},Bt={class:"list-content"},Ot=["onClick"],zt={key:0,class:"status-tag status-queuing"},It={key:1,class:"status-tag status-learning"},Tt={key:2,class:"status-tag status-complete"},Lt={class:"status-tag status-error"},Ft={class:"status-tag status-complete"},Nt=["onClick"],Dt={key:2},At=["onClick"],jt=Ce(()=>C("a",null,"删除",-1)),Mt={class:"upload-file-box"},Et={__name:"knowledge-document",setup(e){const t=Pe(),o=Se(),n=t.query;D(1);const l=D({library_intro:"",library_name:"",use_model:"",is_offline:null}),_=D([]),a=ee({library_id:n.id,file_name:void 0,page:1,size:10,total:0}),m=[{title:"文档名称",dataIndex:"file_name",key:"file_name"},{title:"状态",dataIndex:"status",key:"status"},{title:"文档格式",dataIndex:"file_ext",key:"file_ext"},{title:"文档大小",dataIndex:"file_size_str",key:"file_size"},{title:"上传时间",dataIndex:"create_time",key:"create_time"},{title:"操作",dataIndex:"action",key:"action",width:"120px"}],x=p=>{a.page=p.current,a.size=p.pageSize,d()},y=()=>{a.page=1,d()};let k=!1;const P=({id:p})=>{_.value.length==1&&(k=!0),Qe({id:p}).then(()=>{k&&a.page>1&&a.page--,d(),U.success("删除成功")})},u=p=>{if(p.status=="4")return o.push({path:"/library/document-segmentation",query:{document_id:p.id}});if(p.status=="3")return U.error("学习失败,不可预览");if(p.status=="0")return U.error("排队中,稍候可预览");o.push({name:"libraryPreview",query:{id:p.id}})},d=()=>{Ye($e(a)).then(p=>{l.value=p.data.info;let v=p.data.list||[];a.total=p.data.total,_.value=v.map(S=>(S.file_size_str=We(S.file_size),S.create_time=He(S.create_time*1e3).format("YYYY-MM-DD HH:mm"),S))})};d();const r=ee({open:!1,fileList:[],confirmLoading:!1}),g=()=>{r.fileList=[],r.open=!0},I=()=>{r.fileList=[]},j=p=>{r.fileList=p},q=()=>{if(r.fileList.length==0){U.error("请选择文件");return}r.confirmLoading=!0;let p=new FormData;p.append("library_id",a.library_id),r.fileList.forEach(v=>{p.append("library_files",v)}),Xe(p).then(v=>{d(),r.open=!1,r.fileList=[],r.confirmLoading=!1,o.push("/library/document-segmentation?document_id="+v.data.file_ids[0])}).catch(()=>{r.confirmLoading=!1})};return D(null),(p,v)=>{const S=ge,i=Ge,c=Je,T=_e,L=at,F=yt,N=lt,M=xe,E=Ue;return $(),B("div",kt,[s(M,{scrollbar:!1},{default:w(()=>[C("div",Pt,[C("div",null,[C("div",St,[s(S,{type:"primary",onClick:g},{icon:w(()=>[s(W(ot))]),default:w(()=>[$t]),_:1})])]),C("div",null,[C("div",wt,[s(i,{style:{width:"282px"},value:a.file_name,"onUpdate:value":v[0]||(v[0]=h=>a.file_name=h),placeholder:"请输入文档名称搜索",onChange:y},{suffix:w(()=>[s(W(nt),{style:{color:"rgba(0, 0, 0, 0.25)"}})]),_:1},8,["value"])])])]),C("div",Bt,[s(N,{columns:m,"data-source":_.value,pagination:{current:a.page,total:a.total,pageSize:a.size,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]},onChange:x},{bodyCell:w(({column:h,record:b})=>[h.key==="file_name"?($(),B("a",{key:0,onClick:R=>u(b)},te(b.file_name),9,Ot)):O("",!0),h.key==="status"?($(),B(Y,{key:1},[b.status==0?($(),B("span",zt,[s(c,{size:"small"}),H(" 排队中")])):O("",!0),b.status==1?($(),B("span",It,[s(c,{size:"small"}),H(" 学习中")])):O("",!0),b.status==2?($(),B("span",Tt,[s(W(qe)),H(" 学习完成")])):O("",!0),b.status==3?($(),we(T,{key:3,placement:"top"},{title:w(()=>[C("span",null,te(b.errmsg),1)]),default:w(()=>[C("span",Lt,[s(W(Ve)),H(" 学习失败")])]),_:2},1024)):O("",!0),b.status==4?($(),B(Y,{key:4},[C("span",Ft,[s(W(xt)),H(" 待学习")]),C("a",{class:"ml8",onClick:R=>u(b)},"学习",8,Nt)],64)):O("",!0)],64)):O("",!0),h.key==="action"?($(),B("span",Dt,[C("a",{onClick:R=>u(b)},"预览",8,At),s(L,{type:"vertical"}),s(F,{title:"确定要删除吗?",onConfirm:R=>P(b)},{default:w(()=>[jt]),_:2},1032,["onConfirm"])])):O("",!0)]),_:1},8,["data-source","pagination"])])]),_:1}),s(E,{open:r.open,"onUpdate:open":v[2]||(v[2]=h=>r.open=h),"confirm-loading":r.confirmLoading,maskClosable:!1,title:"上传文档",onOk:q,onCancel:I},{default:w(()=>[C("div",Mt,[s(Ze,{value:r.fileList,"onUpdate:value":v[1]||(v[1]=h=>r.fileList=h),onChange:j},null,8,["value"])])]),_:1},8,["open","confirm-loading"])])}}},$o=Re(Et,[["__scopeId","data-v-4b1314aa"]]);export{$o as default};
